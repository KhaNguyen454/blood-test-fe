import React from "react";
import { Button, Checkbox, Form, Input, Card } from "antd";
import "./login.css";
import { Link, useNavigate } from "react-router-dom";
import { toast } from "react-toastify"; // Import toast

const LoginForm = ({ errorMessage }) => {
  const navigate = useNavigate();

  const onFinish = async (values) => {
    try {
      // Gi·∫£ l·∫≠p g·ªçi API ƒëƒÉng nh·∫≠p
      // const response = await api.post('/login', values);
      // const userData = response.data;

      // Gi·∫£ l·∫≠p th√†nh c√¥ng
      const userData = { email: values.email, fullname: "" };
      localStorage.setItem("user", JSON.stringify(userData));

      // Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng
      toast.success("ƒêƒÉng nh·∫≠p th√†nh c√¥ng!");

      // Ch·ªù m·ªôt ch√∫t r·ªìi chuy·ªÉn trang ƒë·ªÉ ng∆∞·ªùi d√πng k·ªãp th·∫•y th√¥ng b√°o
      setTimeout(() => {
        navigate("/");
      }, 1500);
    } catch (error) {
      // Hi·ªÉn th·ªã th√¥ng b√°o l·ªói
      toast.error("Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ch√≠nh x√°c!");
    }
  };

  return (
    <div className="auth-login-container">
      <div className="auth-login-welcome">
        <div className="auth-login-welcome-content">
          <h1 className="auth-login-welcome-title">
            Ch√†o m·ª´ng ƒë·∫øn v·ªõi HemaLink
          </h1>
          <p className="auth-login-welcome-subtitle">
            N·ªÅn t·∫£ng qu·∫£n l√Ω x√©t nghi·ªám th√¥ng minh ‚Äì ch√≠nh x√°c, nhanh ch√≥ng v√†
            b·∫£o m·∫≠t.
          </p>

          <div className="auth-login-welcome-features">
            <div className="auth-login-welcome-feature">
              <div className="auth-login-welcome-feature-icon">üß™</div>
              <div className="auth-login-welcome-feature-text">
                K·∫øt qu·∫£ x√©t nghi·ªám chu·∫©n x√°c v√† k·ªãp th·ªùi
              </div>
            </div>
            <div className="auth-login-welcome-feature">
              <div className="auth-login-welcome-feature-icon">üìä</div>
              <div className="auth-login-welcome-feature-text">
                Theo d√µi h·ªì s∆° v√† l·ªãch s·ª≠ x√©t nghi·ªám ti·ªán l·ª£i
              </div>
            </div>
            <div className="auth-login-welcome-feature">
              <div className="auth-login-welcome-feature-icon">üîí</div>
              <div className="auth-login-welcome-feature-text">
                B·∫£o m·∫≠t d·ªØ li·ªáu b·ªánh nh√¢n nhi·ªÅu l·ªõp
              </div>
            </div>
            <div className="auth-login-welcome-feature">
              <div className="auth-login-welcome-feature-icon">üë®‚Äç‚öïÔ∏è</div>
              <div className="auth-login-welcome-feature-text">
                K·∫øt n·ªëi nhanh v·ªõi ƒë·ªôi ng≈© y b√°c sƒ©
              </div>
            </div>
          </div>
        </div>
      </div>

      {/* Right Side - Form Section */}
      <div className="auth-login-form-section">
        <div className="auth-login-form-wrapper">
          <Card
            className="auth-login-card"
            title="ƒêƒÇNG NH·∫¨P"
            extra={
              <Link to="/" className="auth-login-back-home">
                Quay v·ªÅ trang ch·ªß
              </Link>
            }
          >
            {errorMessage && (
              <div className="auth-login-error">{errorMessage}</div>
            )}

            <Form
              name="login"
              onFinish={onFinish}
              layout="vertical"
              className="auth-login-form"
            >
              <Form.Item
                label="Email"
                name="email"
                rules={[
                  { required: true, message: "Vui l√≤ng nh·∫≠p email!" },
                  { type: "email", message: "Email kh√¥ng h·ª£p l·ªá!" },
                ]}
              >
                <Input placeholder="Nh·∫≠p email c·ªßa b·∫°n" size="large" />
              </Form.Item>
              <Form.Item
                label="M·∫≠t kh·∫©u"
                name="password"
                rules={[{ required: true, message: "Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u!" }]}
              >
                <Input.Password placeholder="Nh·∫≠p m·∫≠t kh·∫©u" size="large" />
              </Form.Item>
              <Form.Item
                name="remember"
                valuePropName="checked"
                className="auth-login-form-item-remember"
              >
                <div className="auth-login-haha">
                  <Checkbox className="auth-login-checkbox">
                    Ghi nh·ªõ ƒëƒÉng nh·∫≠p
                  </Checkbox>
                  <div className="auth-login-forgot-link">
                    <Link
                      to="/forgot-password"
                      className="auth-login-forgot-link-a"
                    >
                      Qu√™n m·∫≠t kh·∫©u?
                    </Link>
                  </div>
                </div>
              </Form.Item>

              <Form.Item className="auth-login-form-item">
                <Button
                  type="primary"
                  htmlType="submit"
                  block
                  className="auth-login-button"
                  size="large"
                >
                  ƒêƒÉng nh·∫≠p
                </Button>
              </Form.Item>

              <div className="auth-login-register-link">
                Ch∆∞a c√≥ t√†i kho·∫£n?
                <Link to="/register" className="auth-login-register-link-a">
                  ƒêƒÉng k√Ω ngay
                </Link>
              </div>
            </Form>
          </Card>
        </div>
      </div>
    </div>
  );
};

export default LoginForm;
